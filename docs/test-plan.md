# Test plan (План тестирования)

## 1. Introduction (Введение)
*[Введение представляет собой обзор на весь документ в целом и включает в себя следующие разделы - назначение, область применения, определения и аббревиатуры, ссылки и обзор.]]*

### 1.1 Purpose (Назначение)
*[Укажите назначение данного документа.]*

  Целью этого документа является определение целей, ресурсов и процессов для тестирования продукта "Civilla"

### 1.2 Scope (Область применения)  
*[Приведите краткое описание области применения данного документа, к какому(им) проекту(ам) он относится, кто им будет пользоваться и т.д.]*

  Документ предназначен для разработчиков и менеджеров проекта "Civilla", он определяет критерии принятия продукта и отдельных модификаций этого продукта. Соблюдение критериев, указанных в этом документе обеспечивается ручным и автоматическим тестированием. 

### 1.3 Definitions, Acronyms, and Abbreviations (Определения и аббревиатуры)
*[Укажите значение терминов и аббревиатур, которые употребляются в данном документе. Возможно указание ссылки на Глоссарий проекта.]*  
 

### 1.4 References (Ссылки)
*[Перечислите списком названия документов, на которые ссылаетесь в данном, укажите их источники.]*

[Официальный сайт Psycho-Pass](https://psycho-pass.com)  
[Psycho-Pass WiKi](https://psychopass.fandom.com/wiki/Psycho-Pass_Wiki)
[Use-case document](https://github.com/FF220v/ITMO-Psychopass-Team/blob/master/docs/use-cases.md)

### 1.5 Overview (Обзор документа)
*[Укажите краткое описание остальных разделов документа.]*    

## 2. Evaluation Mission and Test Motivation (Цель и мотивы тестирования)

### 2.1 Background (Справочная информация)
*[В данном разделе кратко опишите проект, какие цели он преследует, как будет использоваться, какова его архитектура. Уместны ссылки на другие документы.]*  
  
Проект решает ряд задач, описанных в [Vision](https://github.com/FF220v/ITMO-Psychopass-Team/blob/master/docs/vision.md) и [Use-case document](https://github.com/FF220v/ITMO-Psychopass-Team/blob/master/docs/use-cases.md)

Архитектура проекта описана в документе [Software Architect Document](https://github.com/)


### 2.2 Evaluation Mission (Цели тестирования)
*[В данном разделе укажите, с какой целью проводится тестирование проекта. Например, удовлетворить заказчика, найти как можно больше ошибок до окончательного завершения разработки, выявить самые главные проблемы системы и т.д.]*

Тестирование имеет за собой ряд целей: 
* Формализация требований к принятию продукта (описание процедур, необходимых для признания продукта готовым к использованию заказчиком)
* Обеспечение качества продукта (покрытие существующего функционала тестами, непрерывная проверка продукта на качество)
* Снижение затрат на процесс разработки (следует из первого пункта - формализация процедур, необходимых перед принятием продукта исключает необходимость поиска нового подхода при каждой модификации продукта)


### 2.3 Test Motivators (Мотивы тестирования)
*[Укажите, какие элементы будут служить источником информации для тестирования - функциональные и нефункциональные требования, ограничения системы, риски и т.д.]*

Требования к тестам формулируются исходя из нескольких документов.

1. Тестирование на соответствие требованиям заказчика - документ [Software Requirements Specification](https://github.com/FF220v/ITMO-Psychopass-Team/blob/master/docs/srs.md)

2. Тестирование продукта на способность справиться с возможными ошибками - документ [Risk list](https://github.com/FF220v/ITMO-Psychopass-Team/blob/master/docs/risks-list.md)

3. Наличие функционала, необходимого заказчику для решения прикладных задач - документ [Use-case document](https://github.com/FF220v/ITMO-Psychopass-Team/blob/master/docs/use-cases.md)

## 3. Target Test Items (Целевые объекты тестирования)
*[Перечислите объекты тестирования, т.е. что именно будет проверяться с помощью тестов.]*

Основной объект тестирования - возможности продукта. Они покрываются автоматическими тестами.
1. Каждая прикладная задача, которую может решать заказчик с помощью продукта покрывается автоматическим тестом.
2. Если существуют определенные особые условия, в которых продукт может работать некорректно, этот случай тоже покрывается тестом. Продукт в этом случае должен выдать ожидаемую ошибку или автоматически избежать ошибочного поведения.

Помимо возможностей продукта, которые тестируются в автоматическом режиме, следующие вещи тестируются ручным методом: 
1. Возможности продукта (тестируются в ручном режиме на этапе добавления нового функционала)
2. Процесс развертывания продукта.

## 4. Outline of Planned Tests (План тестов)
*[В данном разделе перечислите все виды тестов, которые будут включены в процесс тестирования. Кратко опишите, что они будут проверять.]*

Автоматические тесты:
1. Function testing - проверяют способность продукта справляться с прикладными задачими пользователя. 

Ручное тестирование:
1. Failover and Recovery Testing - проверка способности продукта справиться с отказами отдельных его частей.
2. Deployment testing - проверка процесса развертывания продукта (автоматическое развертывание в чистой среде с последующим запуском функциональных тестов)


## 5. Test Approach (Подход к тестированию)
*[Данный раздел представляет рекомендованные стратегии для разработки и выполнения обязательных тестов. Не все виды тестов обязательно должны быть реализованы.]*

### 5.1 Testing Techniques and Types (Техники тестирования)

#### 5.1.1 Function Testing (Функциональное тестирование)

<table>
<tr><td>

Technique Objective:
(Цель)
</td><td>

Обеспечение возможностей продукта, позволяющих решать прикладные задачи заказчика.
</td></tr><tr><td>

Technique:
(Описание процесса)
</td><td>

- Автоматические тесты запускаются с помощью скрипта в среде разработчика. Каждый тест проверяет один пользовательский сценарий.
- Новые сценарии тестируются дополнительно вручную.
</td></tr><tr><td>

Oracles:
(Источники)
</td><td>

- [Use-case document](https://github.com/FF220v/ITMO-Psychopass-Team/blob/master/docs/use-cases.md)
- [Software Requirements Specification](https://github.com/FF220v/ITMO-Psychopass-Team/blob/master/docs/srs.md)
</td></tr><tr><td>

Required Tools:
(Инструменты)
</td><td>

- Среда разработчика, включающая в себя продукт, развернутый в kubernetes локально.
- Фреймворк для тестирования pytest, pyrogram-телеграм клиент, запускающиеся локально, в docker-контейнерах.
</td></tr><tr><td>

Success Criteria:
(Критерий успеха)
</td><td>

- Все тесты проходят успешно.
- Результаты ручного тестирования новых возможностей продукта соответствуют ожиданиям.

</td></tr>
</table>

#### 5.1.2 Business Cycle Testing (Тестирование)

<table>
<tr><td>

Technique Objective:
(Цель)
</td><td>

Тестирование совокупности возможностей продукта, позволяющих решать прикладные задачи заказчика.
</td></tr><tr><td>

Technique:
(Описание процесса)
</td><td>

- Автоматические тесты запускаются с помощью скрипта в среде разработчика. 
- Тесты могут быть совмещены с функциональными тестами, для этого тестирование должно проводиться не с чистого листа, а с сохранением данных от предыдущих тестов.
</td></tr><tr><td>

Oracles:
(Источники)
</td><td>

- [Use-case document](https://github.com/FF220v/ITMO-Psychopass-Team/blob/master/docs/use-cases.md)
- [Software Requirements Specification](https://github.com/FF220v/ITMO-Psychopass-Team/blob/master/docs/srs.md)
</td></tr><tr><td>

Required Tools:
(Инструменты)
</td><td>

- Среда разработчика, включающая в себя продукт, развернутый в kubernetes локально.
- Фреймворк для тестирования pytest, pyrogram-телеграм клиент, запускающиеся локально, в docker-контейнерах.
</td></tr><tr><td>

Success Criteria:
(Критерий успеха)
</td><td>

- Все тесты проходят успешно.
</td></tr>
</table>

#### 5.1.3 Failover and Recovery Testing (Тестирование на отказ и восстановление)

<table>
<tr><td>

Technique Objective:
(Цель)
</td><td>

Обеспечение возможностей продукта, позволяющих доставлять пользу заказчику непрерывно.
</td></tr><tr><td>

Technique:
(Описание процесса)
</td><td>

- Автоматические тесты на заведомо ошибочные сценарии.
- Ручное тестирование на отказ одной или нескольких составляющих ПО.
</td><td>

</td></tr><tr><td>

Oracles:
(Источники)
</td><td>

- [Use-case document](https://github.com/FF220v/ITMO-Psychopass-Team/blob/master/docs/use-cases.md)
- [Risk list](https://github.com/FF220v/ITMO-Psychopass-Team/blob/master/docs/risks-list.md)
- [Software Requirements Specification](https://github.com/FF220v/ITMO-Psychopass-Team/blob/master/docs/srs.md)
</td></tr><tr><td>

Required Tools:
(Инструменты)
</td><td>

- Среда разработчика, включающая в себя продукт, развернутый в kubernetes локально.
- Фреймворки для тестирования pytest, selenium, запускающиеся локально, в docker-контейнерах.
</td></tr><tr><td>

Success Criteria:
(Критерий успеха)
</td><td>

- Все тесты на ошибочные сценарии проходят.
- Ручное тестирование показывает бесперебойную работу продукта при выводе из строя одной из реплик части продукта.
</td></tr>
</table>

#### 5.1.4 Deployment testing (Тестирование развертывания)

<table>
<tr><td>

Technique Objective:
(Цель)
</td><td>

Обеспечение бесперебойной доставки продукта заказчику.
</td></tr><tr><td>

Technique:
(Описание процесса)
</td><td>

При добавлении новых возможностей в продукт, разработчик проводит ручное развертывание продукта в локальном кластере и запускает функциональные тесты.
</td></tr><tr><td>

Oracles:
(Источники)
</td><td>

- [Software Requirements Specification](https://github.com/FF220v/ITMO-Psychopass-Team/blob/master/docs/srs.md)
</td></tr><tr><td>

Required Tools:
(Инструменты)
</td><td>

Среда разработчика, включающая в себя инструменты для развертывания продукта и функционального тестирования.
</td></tr><tr><td>

Success Criteria:
(Критерий успеха)
</td><td>

Функциональные тесты успешно проходят после развертывания продукта в чистой среде.
</td></tr>
</table>

#### 5.1.5 User Interface Testing  (Тестирование интерфейса)

<table>
<tr><td>

Technique Objective:
(Цель)
</td><td>

Обеспечение интерфейса, содержащего необходимые элементы для использования продукта заказчиком, обеспечение демонстрации только необходимого функционала соответствующим группам пользователей.
</td></tr><tr><td>

Technique:
(Описание процесса)
</td><td>

 - Автоматические тесты запускаются с помощью скрипта в среде разработчика. Тесты проверяют, какие элементы интерфейса видит пользователь в разных ситуациях.
 - Визуальная оценка интерфейса вручную.
</td></tr><tr><td>

Oracles:
(Источники)
</td><td>

- [Use-case document](https://github.com/FF220v/ITMO-Psychopass-Team/blob/master/docs/use-cases.md)
- [Software Requirements Specification](https://github.com/FF220v/ITMO-Psychopass-Team/blob/master/docs/srs.md)
</td></tr><tr><td>

Required Tools:
(Инструменты)
</td><td>

- Среда разработчика, включающая в себя продукт, развернутый в kubernetes локально.
- Фреймворк для тестирования pytest, pyrogram-телеграм клиент, запускающиеся локально, в docker-контейнерах.
</td></tr><tr><td>

Success Criteria:
(Критерий успеха)
</td><td>

- Все тесты проходят успешно.
- Результаты ручного тестирования новых возможностей продукта соответствуют ожиданиям.

</td></tr>
</table>

#### 5.1.6 Database Testing  (Тестирование базы данных)

<table>
<tr><td>

Technique Objective:
(Цель)
</td><td>

- Обеспечение правильного функционирования базы данных, а именно, правильного сохранения в неё состояний системы.
- Валидация тестов, использующих заготовленние данные, сохраняющиеся в базу данных.
</td></tr><tr><td>

Technique:
(Описание процесса)
</td><td>

 - Автоматические тесты запускаются с помощью скрипта в среде разработчика.
 - Тесты могут быть совмещены с функциональными тестами.
 - Тесты проверяют конечные состояния базы даннах в разных случаях.
</td></tr><tr><td>

Oracles:
(Источники)
</td><td>

- [Use-case document](https://github.com/FF220v/ITMO-Psychopass-Team/blob/master/docs/use-cases.md)
- [Software Requirements Specification](https://github.com/FF220v/ITMO-Psychopass-Team/blob/master/docs/srs.md)
</td></tr><tr><td>

Required Tools:
(Инструменты)
</td><td>

- Среда разработчика, включающая в себя продукт, развернутый в kubernetes локально.
- Фреймворк для тестирования pytest, pyrogram-телеграм клиент, запускающиеся локально, в docker-контейнерах.
- Kubectl - утилита для управления кластером, для форвардинга портов в базу данных.
</td></tr><tr><td>

Success Criteria:
(Критерий успеха)
</td><td>

- Все тесты проходят успешно.
- Результаты ручного тестирования новых возможностей продукта соответствуют ожиданиям.

</td></tr>
</table>

#### 5.1.7 Configuration Testing (Тестирование конфигурации)

<table>
<tr><td>

Technique Objective:
(Цель)
</td><td>

Обеспечение работоспособности продукта.
</td></tr><tr><td>

Technique:
(Описание процесса)
</td><td>

- Автоматические тесты запускаются с помощью скрипта в среде разработчика. 
- Тесты могут быть совмещены с функциональными тестами в случае, если прохождение функциональных тестов предполагает наличие корректной конфигурации.
</td></tr><tr><td>

Oracles:
(Источники)
</td><td>

- [Use-case document](https://github.com/FF220v/ITMO-Psychopass-Team/blob/master/docs/use-cases.md)
- [Software Requirements Specification](https://github.com/FF220v/ITMO-Psychopass-Team/blob/master/docs/srs.md)
</td></tr><tr><td>

Required Tools:
(Инструменты)
</td><td>

- Среда разработчика, включающая в себя продукт, развернутый в kubernetes локально.
- Фреймворк для тестирования pytest, pyrogram-телеграм клиент, запускающиеся локально, в docker-контейнерах.
</td></tr><tr><td>

Success Criteria:
(Критерий успеха)
</td><td>

- Все тесты проходят успешно.

</td></tr>
</table>

## Entry and Exit Criteria (Критерии старта и окончания)

### 6.1. Test Plan Entry Criteria (Критерий старта)
*[Укажите условие, при котором можно начать процесс тестирования]*

Среда разработчика настроена, внесены необходимые изменения в продукт / продукт первоначально подготовлен к поставке заказчику.

### 6.2 Test Plan Exit Criteria (Критерий окончания)
*[Укажите условие, при котором процесс тестирования считается оконченным.]*

Получены положительные или отрицательные результаты тестирования.

### 6.3 Suspension and Resumption Criteria (Критерий паузы и возобновления)
*[Укажите условие, при котором необходимо приостановить процесс тестирования и при котором продолжить.]*

Один или несколько тестов провалились, разработчик вносит изменения в продукт, чтобы исправить ошибки и начинает тестирование заново.

## 7. Deliverables (Ожидаемые результаты тестирования)
*[В данном разделе перечислите артефакты, которые будут созданы в процессе тестирования.]*

### 7.1 Test Evaluation Summaries (Результаты выполнения тестов)
*[Опишите формат и содержание результатов выполнения тестирования]*

Формат результатов тестов: 
- Отчет в виде логов выполнения тестов фреймворком pytest. Список проваленных тестов, логи выполнения проваленных тестов.
- Отметка в pull request разработчика о том, что ручные этапы тестирования были проведены.

### 7.2 Perceived Quality Reports (Оценка качества)
*[Опишите формат и содержание отчета о качестве разрабатываемой системы]*

В нашем случае формат отчета несет бинарный характер: Если тесты прошли, в pull request ставятся отметки о пройденных тестах и изменения вносятся в продукт. В обратном случае продукт дорабатываетсся.

### 7.3 Incident Logs and Change Requests (Журналы ошибок и изменений)
*[Опишите, каким образом будут фиксироваться найденные ошибки в системе, а также изменения, сделанные с целью их исправить.]*

Если тест, который ранее работал, перестает работать, в github заносится новая issue, менеджером проекта оценивается серьезность поломки, задача на исправление назначается разработчику, в зависимости от серьёзности проблемы выбирается приоритет этой задачи. Когда разработчик осуществляет починку, изменения вносятся в главную ветку проекта, issue закрывается.

## 8. Environmental Needs (Необходимое окружение для проведения тестирования)

### 8.1 Base System Hardware (Базовое аппаратное обеспечение)
*[Опишите в таблице, приведенной ниже, конфигурацию систем(ы), на которой будут запускаться тесты]*

Тесты запускаются на Hyper-V виртуальной машине со следующими значениями ресурсов: 

<table>
<tr><td>

**Resource (Ресурс)**
</td><td>

**Quantity (Количество)**
</td><td>

**Name and Type (Название и тип)**

</td></tr>
<tr><td>

CPU
</td><td>

4
</td><td>

x86 processor
</td></tr>
<tr><td>

RAM
</td><td>

8Gi
</td><td>

DDR4 RAM
</td></tr> 
<tr><td>

Disk
</td><td>

50Gi
</td><td>

SSD
</td></tr> 

<tr><td>

Stable internet connection
</td><td>

100 Mbps
</td><td>

internet connection
</td></tr> 

</table>

### 8.2 Base Software Elements in the Test Environment (Базовые программы тестового окружения)
*[Опишите в таблице, приведенное ниже, какие программы должны быть установлены на тестовой(ых) системе(ах).]*

Все программы тестового окружения развертываются на виртуальной машине автоматически вместе со средой разработчика.
Ниже приведены основные инструменты, которые используются при настройке, развертывании и тестировании продукта.

<table>
<tr><td>

**Software Element Name (Название)**
</td><td>

**Version (Версия)**
</td><td>

**Type (Тип)**

</td></tr>
<tr><td>

Ubuntu
</td><td>

20.04
</td><td>

Operating system
</td></tr>
<tr><td>

Kubernetes (microk8s)
</td><td>

1.16
</td><td>

Container orchestration system
</td></tr> 
<tr><td>

Docker
</td><td>

18.05
</td><td>

Platform for developing, shipping, and running applications.
</td></tr> 

<tr><td>

git
</td><td>

2.29.2
</td><td>

Version control repository tool
</td></tr> 

<tr><td>

sops
</td><td>

3.6.1 
</td><td>

Tool for managing encrypted json and yaml files
</td></tr> 
</table>


## 8.3 Productivity and Support Tools (Вспомогательные инструменты)
*[Опишите в таблице, приведенное ниже, какие программы будут полезны для проведения тестирования.]*
 
Для проведения ручного тестирования будет полезно иметь следующие инструменты:

<table>
<tr><td>

**Tool Category or Type (Тип программы)**
</td><td>

**Tool Brand Name (Название)**
</td><td>

**Vendor (Производитель)**
</td><td>

**Version (Версия)**
</td></tr>
<tr><td>

Web browser
</td><td>

Chrome
</td><td>

Google
</td><td>

87
</td></tr>
<tr><td>

Messenger
</td><td>

telegram
</td><td>

telegram
</td><td>

2.4
</td></tr>
</table>

## 9. Responsibilities, Staffing, and Training Needs (Обязанности сотрудников)
*[В данном разделе описываются необходимые навыки и знания людей, осуществляющих процесс тестирования.]*

### 9.1 People and Roles (Люди и роли) 

<table>
<tr><td>

**Role (Роль)**
</td><td>

**Minimum Resources Recommended (Минимально необходимое количество людей)**
</td><td>

**Specific Responsbilities (Обязанности)**

</td></tr>
<tr><td>

Developer
</td><td>

1
</td><td>

Разрабатывает новый функционал продукта, покрывает этот функционал тестами, производит ручное и автоматическое тестирование продукта.
</td></tr>
<tr><td>

Reviewer
</td><td>

1
</td><td>

Производит ревью pull request разработчика функциональности продукта, убеждается в том, что тестирование проведено, утверждает pull request.
</td></tr> 
</table>

## 10. Management Process and Procedures (Управление)
*[Данный раздел содержит описание различных мероприятий по управлению процессом тестирования]*

### 10.1 Reporting on Test Coverage (Сообщение о тестовом покрытии)
*[Опишите процесс рецензирования результатов тестирования.]*

Разработчик перед тем, как внести изменения в продукт заполняет специальную форму, где указывает, прошли или нет определенные типы тестов.

### 10.2 Problem Reporting, Escalation, and Issue Resolution (Выявление, избегание и решение проблем)
*[Опишите, каким образом будет вестись учет проблем, возникших во время выполнения тестов, и какие действия нужно предпринять для их решения.]*

- Если проблема возникает в связи с вносимыми в продукт изменениями, то изменения не вносятся, пока неполадки не будут устранены (избегаем регрессии функционала)
- Если проблема возникает не зависимо от вносимых в продукт изменений (например, изменилось поведение внешней системы), то в github заносится новая issue, менеджером проекта оценивается серьезность поломки, задача на исправление назначается разработчику, в зависимости от серьёзности проблемы выбирается приоритет этой задачи. Когда разработчик осуществляет починку, изменения вносятся в главную ветку проекта, issue закрывается.

### 10.3 Approval and Signoff (Утверждение плана тестирования)
*[Опишите процесс утверждения данного плана тестирования, а также укажите список лиц, участвующих в нём.]*

Команда разработки проекта Civilla утверждает этот план тестирования.